<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pythagorean Theorem – Geometric Proof (Animated)</title>
  <style>
    :root {
      --bg: #0f172a;
      --card: #111827;
      --ink: #e5e7eb;
      --muted: #9ca3af;
      --accent: #60a5fa;
      --legA: #22c55e;
      --legB: #f59e0b;
      --hyp: #a78bfa;
      --alt: #ef4444;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; padding: 24px; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial;
      color: var(--ink); background: radial-gradient(1200px 800px at 20% 10%, #1e293b, var(--bg));
    }
    .wrap { max-width: 1100px; margin: 0 auto; }
    h1 { margin: 0 0 12px; font-weight: 800; letter-spacing: -0.02em; }
    .subtitle { color: var(--muted); margin-bottom: 18px; }
    .card { background: linear-gradient(180deg, #0b1220, #0b1220cc 60%, #0b1220); border: 1px solid #1f2937;
      border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,.35); padding: 20px; }
    .flex { display: flex; gap: 22px; flex-wrap: wrap; align-items: stretch; }
    .left { flex: 1 1 640px; min-width: 360px; }
    .right { flex: 1 1 320px; min-width: 280px; display: flex; flex-direction: column; gap: 14px; }

    .controls { display: flex; gap: 10px; flex-wrap: wrap; align-items: center; }
    button { appearance: none; border: 0; color: #0b1220; background: #e5e7eb; font-weight: 700; padding: 10px 16px;
      border-radius: 999px; cursor: pointer; transition: transform .08s ease, box-shadow .2s ease, background .2s ease; }
    button.primary { background: linear-gradient(135deg, #34d399, #22c55e); color: #052e1b; }
    button:hover { transform: translateY(-1px); box-shadow: 0 8px 22px rgba(0,0,0,.25); }
    button:disabled { opacity: .5; cursor: not-allowed; transform: none; box-shadow: none; }

    .panel { background: #0b1220; border: 1px solid #1f2937; border-radius: 12px; padding: 14px 16px; }
    .stepTitle { font-weight: 800; color: #bfdbfe; margin-bottom: 6px; }
    .math { font-family: 'Times New Roman', serif; font-style: italic; color: #f8fafc; }
    .note { color: var(--muted); font-size: 14px; }

  svg { width: 100%; height: auto; background: #ffffff; border-radius: 12px; border: 1px solid #e5e7eb; }

    .tri-main { fill: rgba(99, 102, 241, .12); stroke: var(--accent); stroke-width: 3; }
    .tri-adb { fill: rgba(245, 158, 11, .20); stroke: var(--legB); stroke-width: 2.2; }
    .tri-bdc { fill: rgba(34, 197, 94, .20); stroke: var(--legA); stroke-width: 2.2; }

    .leg-a { stroke: var(--legA); stroke-width: 4; }
    .leg-b { stroke: var(--legB); stroke-width: 4; }
    .hyp { stroke: var(--hyp); stroke-width: 4; }
    .altitude { stroke: var(--alt); stroke-width: 3; stroke-dasharray: 7 6; }

    .pt { fill: #111827; stroke: #111827; stroke-width: 0; }
    .label { font-size: 16px; font-weight: 700; fill: #111827; }
    .sidelabel { font-size: 14px; fill: #111827; opacity: .8; }
    .arealabel { font-size: 12px; fill: #111827; font-weight: 700; opacity: .9; }

  /* Squares on the three sides */
  .sq-b { fill: rgba(34, 197, 94, .15); stroke: var(--legA); stroke-width: 2.2; }
  .sq-c { fill: rgba(167, 139, 250, .15); stroke: var(--hyp); stroke-width: 2.2; }
  .sq-a { fill: rgba(245, 158, 11, .15); stroke: var(--legB); stroke-width: 2.2; }
  .sqtext { font-size: 18px; fill: #111827; font-weight: 800; }

    .fade { opacity: 0; transition: opacity .6s ease, filter .4s ease; filter: saturate(.5); }
    .show { opacity: 1; filter: saturate(1); }
    .pulse { animation: pulse 1.8s ease-in-out 2; }
    @keyframes pulse { 0%, 100% { filter: brightness(1); } 50% { filter: brightness(1.3); } }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Pythagorean Theorem – Geometric Proof</h1>
    <div class="subtitle">Right triangle ABC with right angle at B; altitude from B to hypotenuse AC; similar sub-triangles; area scaling.</div>

    <div class="card flex">
      <div class="left">
        <!-- ViewBox coordinates are SVG pixels. We choose coordinates so B is a right angle. -->
  <svg viewBox="-60 -160 760 1040" aria-label="Animated geometric proof">
          <!-- Triangle points: A(150,350), B(150,150), C(450,150) so angle at B is 90°. -->
          <!-- Hypotenuse AC vector v=(300,-200). H divides AC in ratio AH:HC = AB^2:BC^2 = 200^2:300^2 = 4:9, so t=4/13. -->
          <!-- H = A + t*v ≈ (242.3077, 288.4615). -->

          <!-- Grid for context -->
          <defs>
            <pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse">
              <path d="M20 0H0V20" fill="none" stroke="#f0f0f0" stroke-width="0.6" />
            </pattern>
          </defs>
          <rect x="-60" y="-160" width="760" height="1040" fill="url(#grid)" />

          <!-- Squares on sides: AB (a^2, orange), BC (b^2, green), AC (c^2, purple) -->
          <!-- AB square to the left of AB using w = (-200, 0) -->
          <polygon id="sqAB" class="sq-a fade" points="150,350 150,150 -50,150 -50,350" />
          <!-- BC square above BC using w = (0, -300) -->
          <polygon id="sqBC" class="sq-b fade" points="150,150 450,150 450,-150 150,-150" />
          <!-- AC square now attached to the copy's hypotenuse (A'=(190,570), C'=(490,370), w=(200,300)) -->
          <polygon id="sqAC" class="sq-c fade" points="190,570 490,370 690,670 390,870" />
          
          <!-- Square labels -->
          <text id="sqLab_a2" class="sqtext fade" x="50" y="250">a²</text>
          <text id="sqLab_b2" class="sqtext fade" x="300" y="0">b²</text>
          <text id="sqLab_c2" class="sqtext fade" x="440" y="620">c²</text>

          <!-- Main triangle ABC -->
          <polygon id="ABC" class="tri-main fade" points="150,350 150,150 450,150" />

          <!-- Copy of the main triangle, shifted bottom-right just enough not to overlap -->
          <!-- A'=(190,570), B'=(190,370), C'=(490,370) -->
          <polygon id="ABC_copy" class="tri-main fade" points="190,570 190,370 490,370" />

          <!-- Sides (emphasized): AB vertical, BC horizontal, AC hypotenuse -->
          <line id="AB" class="leg-b fade" x1="150" y1="350" x2="150" y2="150" />
          <line id="BC" class="leg-a fade" x1="150" y1="150" x2="450" y2="150" />
          <line id="AC" class="hyp fade" x1="150" y1="350" x2="450" y2="150" />

          <!-- Altitude BH to hypotenuse AC -->
          <line id="BH" class="altitude fade" x1="150" y1="150" x2="242.3077" y2="288.4615" />

          <!-- Sub-triangles -->
          <polygon id="AHB" class="tri-adb fade" points="150,350 150,150 242.3077,288.4615" />
          <polygon id="BHC" class="tri-bdc fade" points="150,150 242.3077,288.4615 450,150" />

          <!-- Points -->
          <circle id="Apt" class="pt fade" cx="150" cy="350" r="4" />
          <circle id="Bpt" class="pt fade" cx="150" cy="150" r="4" />
          <circle id="Cpt" class="pt fade" cx="450" cy="150" r="4" />
          <circle id="Hpt" class="pt fade" cx="242.3077" cy="288.4615" r="4" />

          <!-- Labels -->
          <text id="Alab" class="label fade" x="132" y="364">A</text>
          <text id="Blab" class="label fade" x="132" y="146">B</text>
          <text id="Clab" class="label fade" x="456" y="146">C</text>
          <text id="Hlab" class="label fade" x="250" y="300">H</text>

          <!-- Side labels -->
          <text id="labAB" class="sidelabel fade" x="90" y="255">a = |AB|</text>
          <text id="labBC" class="sidelabel fade" x="290" y="140">b = |BC|</text>
          <text id="labAC" class="sidelabel fade" x="290" y="270">c = |AC|</text>

          <!-- Right angle marker at B -->
          <path id="rightB" class="fade" d="M 150 170 L 170 170 L 170 150" stroke="#111827" stroke-width="3" fill="none" />

          <!-- Area labels -->
          <text id="areaABC" class="arealabel fade" x="245" y="430">[ABC]</text>
          <text id="areaAHB" class="arealabel fade" x="160" y="255">[AHB]</text>
          <text id="areaBHC" class="arealabel fade" x="305" y="220">[BHC]</text>
        </svg>
      </div>

      <div class="right">
        <div class="panel">
          <div class="stepTitle" id="stepTitle">Welcome</div>
          <div id="stepDesc">Use Play/Next to step through the geometric proof.</div>
          <div class="math" id="stepMath" style="margin-top:8px;"></div>
        </div>

        <div class="panel">
          <div class="controls">
            <button id="prevBtn" onclick="prev()">◀ Previous</button>
            <button class="primary" id="playBtn" onclick="togglePlay()">▶ Play</button>
            <button id="nextBtn" onclick="next()">Next ▶</button>
            <button onclick="resetAll()">↻ Reset</button>
          </div>
          <div class="note" style="margin-top:8px;">
            Goal: prove c² = a² + b² with area partition and similar triangles.
          </div>
        </div>

        <div class="panel">
          <div class="stepTitle">Step index</div>
          <ol id="stepList" class="note" style="margin: 0 0 0 18px;">
            <li>Triangle setup (right angle at B)</li>
            <li>Label sides a, b, c</li>
            <li>Draw altitude BH to hypotenuse AC</li>
            <li>Sub-triangles AHB and BHC partition area</li>
            <li>Similarity: △ABC ~ △AHB ~ △BHC</li>
            <li>Area ratios scale as square of side ratios</li>
            <li>Conclude c² = a² + b²</li>
          </ol>
        </div>
      </div>
    </div>
  </div>

  <script>
    const steps = [
      {
        title: 'Step 1 – Right triangle ABC',
        desc: 'Construct △ABC with ∠B = 90°. AB is vertical, BC is horizontal, AC is the hypotenuse.',
        math: '∠ABC = 90°',
        show: ['ABC','AB','BC','AC','Apt','Bpt','Cpt','Alab','Blab','Clab','rightB']
      },
      {
        title: 'Step 2 – Label the sides',
        desc: 'Let b = |BC|, a = |AB|, and c = |AC| (the hypotenuse).',
        math: 'We aim to show: c² = a² + b²',
        show: ['labAB','labBC','labAC']
      },
      {
        title: 'Step 3 – Drop the altitude',
        desc: 'From the right angle B, drop the perpendicular BH to the hypotenuse AC. H is the foot.',
        math: 'BH ⟂ AC',
        show: ['BH','Hpt','Hlab']
      },
      {
        title: 'Step 4 – Area partition',
        desc: 'The altitude splits △ABC into two smaller triangles: △AHB and △BHC. Their areas sum to the whole.',
        math: '[ABC] = [AHB] + [BHC]',
        show: ['AHB','BHC','areaABC','areaAHB','areaBHC','ABC_copy']
      },
      {
        title: 'Step 5 – Triangle similarity',
        desc: 'By AA: △ABC ~ △AHB and △ABC ~ △BHC (they share an acute angle and each has a right angle).',
        math: '△ABC ~ △AHB ~ △BHC',
        pulse: ['AB','AC','BH','AHB','BHC']
      },
      {
        title: 'Step 6 – Area scales as length²',
        desc: 'For similar figures, area ratios equal the square of linear scale factors for corresponding sides.',
        math: '[ABC]/c² = [AHB]/a² = [BHC]/b²',
        show: ['sqAB','sqBC','sqAC','sqLab_a2','sqLab_b2','sqLab_c2'],
        pulse: ['areaABC','areaAHB','areaBHC','labAB','labBC','labAC','sqAB','sqBC','sqAC']
      },
      {
        title: 'Step 7 – Pythagorean conclusion',
        desc: 'Combine the partition [ABC] = [AHB] + [BHC] with the equal ratios to obtain c² = a² + b².',
        math: 'c² = a² + b²',
        pulse: ['AC','ABC']
      }
    ];

    const els = Object.fromEntries([
      'ABC','AB','BC','AC','BH','AHB','BHC',
      'ABC_copy',
      'Apt','Bpt','Cpt','Hpt',
      'Alab','Blab','Clab','Hlab',
      'labAB','labBC','labAC',
      'rightB','areaABC','areaAHB','areaBHC',
      'sqAB','sqBC','sqAC','sqLab_a2','sqLab_b2','sqLab_c2'
    ].map(id => [id, document.getElementById(id)]));

    const titleEl = document.getElementById('stepTitle');
    const descEl  = document.getElementById('stepDesc');
    const mathEl  = document.getElementById('stepMath');

    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const playBtn = document.getElementById('playBtn');

    let i = 0; let timer = null; let playing = false;

    function setVisible(idList, on=true) {
      idList.forEach(id => { if (!els[id]) return; els[id].classList.toggle('show', on); });
    }
    function pulse(idList) {
      idList.forEach(id => { if (!els[id]) return; els[id].classList.remove('pulse'); void els[id].offsetWidth; els[id].classList.add('pulse'); });
    }

    // Ensure the diagram reflects exactly the selected step by:
    // 1) hiding everything, 2) showing the union of all "show" items from step 0..index,
    // 3) applying pulses for the current step only.
    function setStateForStep(index) {
      // Hide all and clear pulses
      Object.values(els).forEach(el => { if (!el) return; el.classList.remove('show', 'pulse'); });

      // Compute the set of visible items up to the current step
      const visible = new Set();
      for (let k = 0; k <= index; k++) {
        const s = steps[k];
        if (s && s.show) s.show.forEach(id => visible.add(id));
      }

      // Show them
      visible.forEach(id => { if (!els[id]) return; els[id].classList.add('show'); });

      // Pulse current step highlights
      const cur = steps[index];
      if (cur && cur.pulse) pulse(cur.pulse);
    }

    function renderStep() {
      const s = steps[i];
      titleEl.textContent = s.title;
      descEl.textContent = s.desc;
      mathEl.textContent = s.math || '';
      setStateForStep(i);
      // Animate copy triangle entering at Step 4 (index 3)
      if (i === 3) {
        animateCopyFromOriginal();
      }
      prevBtn.disabled = i === 0;
      nextBtn.disabled = i === steps.length - 1;
    }

    function next() {
      if (i < steps.length - 1) { i++; renderStep(); if (i === steps.length - 1) stop(); }
    }
    function prev() {
      if (i > 0) { i--; renderStep(); }
    }
    function stop() {
      playing = false; clearInterval(timer); timer = null; playBtn.textContent = '▶ Play';
    }
    function togglePlay() {
      if (playing) { stop(); return; }
      if (i === steps.length - 1) { resetAll(); }
      playing = true; playBtn.textContent = '⏸ Pause';
      timer = setInterval(() => { next(); if (i === steps.length - 1) stop(); }, 2400);
    }
    function resetAll() {
      stop(); i = 0;
      // hide all
      Object.values(els).forEach(el => el.classList.remove('show','pulse'));
      // initial view can show just the frame
      renderStep();
    }

    // Initialize
    resetAll();

    // --- Animation helpers for the copied triangle ---
    // The copy (ABC_copy) is a pure translate of the original by (dx, dy)
    const COPY_DX = 40;   // 190-150
    const COPY_DY = 220;  // 370-150 (using B -> B')
    function animateCopyFromOriginal() {
      const el1 = els['ABC_copy'];
      const el2 = els['areaABC'];
      if (!el1 || !el2) return;
      // Start at original position
      el1.style.transition = 'none';
      el1.style.transform = `translate(${-COPY_DX}px, ${-COPY_DY}px)`;
      el2.style.transition = 'none';
      el2.style.transform = `translate(${-COPY_DX}px, ${-COPY_DY}px)`;
      // Force reflow to apply initial state before animating
      void el1.getBoundingClientRect();
      setTimeout(() => {
        // Animate to final location
        el1.style.transition = 'transform 800ms ease';
        el2.style.transition = 'transform 800ms ease';
        el1.style.transform = 'translate(0px, 0px)';
        el2.style.transform = 'translate(0px, 0px)';
      }, 50);
    }
  </script>
</body>
</html>